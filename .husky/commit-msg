#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Read the commit message
commit_regex='^(ğŸ¯|âœˆï¸|ğŸ®|ğŸŒ|ğŸ¨|âš¡|ğŸ”§|ğŸ“¦|ğŸ§ª|ğŸ›|ğŸ“|â™»ï¸|ğŸš€|ğŸ”Š|ğŸŒ¤ï¸|ğŸ“Š|ğŸ’¡|ğŸ”’|ğŸ‘¥|ğŸ“ˆ|ğŸš§|â¬†ï¸|â¬‡ï¸|â•|â–|ğŸ”¥|ğŸ’š|âœ…|ğŸš¨|ğŸ’„|â™¿|ğŸŒ|âœï¸|ğŸ’©|âª|ğŸ”€|ğŸ“±|ğŸ¥š|ğŸ™ˆ|ğŸ“¸|âš—ï¸|ğŸ”|ğŸ·ï¸|ğŸŒ±|ğŸš©|ğŸ¥…|ğŸ’«|ğŸ—‘ï¸|ğŸ›‚|ğŸ©¹|ğŸ§|âš°ï¸|ğŸ§‘â€ğŸ’»|ğŸ—ï¸|ğŸ§±|ğŸ‘·|ğŸ“„|ğŸ’¸|ğŸ») .{1,100}$'

commit_message=$(cat "$1")

if ! echo "$commit_message" | grep -qE "$commit_regex"; then
    echo "âŒ Invalid commit message format!"
    echo ""
    echo "Commit message must:"
    echo "  1. Start with an emoji from the project's emoji guide"
    echo "  2. Be followed by a space and descriptive message"
    echo "  3. Be no longer than 100 characters"
    echo ""
    echo "Example: âœˆï¸ Implement ground effect modeling"
    echo ""
    echo "Emoji guide:"
    echo "  ğŸ¯ Planning and architecture"
    echo "  âœˆï¸ Flight mechanics"
    echo "  ğŸ® Controls and input"
    echo "  ğŸŒ World and terrain"
    echo "  ğŸ¨ Graphics and rendering"
    echo "  âš¡ Performance optimizations"
    echo "  ğŸ”§ Configuration and setup"
    echo "  ğŸ“¦ Dependencies"
    echo "  ğŸ§ª Testing"
    echo "  ğŸ› Bug fixes"
    echo "  ğŸ“ Documentation"
    echo "  â™»ï¸ Refactoring"
    echo "  ğŸš€ New features"
    echo ""
    exit 1
fi

echo "âœ… Commit message format is valid!"